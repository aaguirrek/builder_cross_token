"use strict";(self["webpackChunkquant_ux"]=self["webpackChunkquant_ux"]||[]).push([[977],{59740:function(t,e,s){s.d(e,{A:function(){return u}});var o=function(){var t=this,e=t._self._c;return e("ZoomDialog",{ref:"dialog"},[e("div",{staticClass:"MatcDialog MatcErrorDialog"},[e("h2",{staticClass:"title"},[t._v(t._s(t.message))]),e("label",[t._v("Stack")]),e("pre",{staticClass:"MatcErrorStackTrace"},[t._v(t._s(t.stack))]),e("label",[t._v("Trace")]),e("pre",{staticClass:"MatcErrorStackTrace"},[t._v(t._s(t.trace))]),e("div",{staticClass:"MatcButtonBar MatcMarginTop"},[e("a",{staticClass:"MatcButton",on:{click:t.close}},[t._v("Close")]),e("a",{staticClass:"MatcButton",on:{click:function(e){t.doNotShowAgain=!0,t.close()}}},[t._v("Do not show again")])])])])},a=[],i=s(47681),r=s(91098),n={name:"ErrorDialog",props:["pub"],mixins:[],data:function(){return{message:"",stack:"",trace:"",doNotShowAgain:!1}},watch:{},components:{ZoomDialog:r.A},methods:{close(){this.$refs.dialog.close()},show(t,e){this.doNotShowAgain||(this.$refs.dialog.show(),this.message=t,this.stack=t.stack.trim(),this.trace=e)}},async mounted(){this.logger=new i.A("ErrorDialog")}},l=n,c=s(81656),g=(0,c.A)(l,o,a,!1,null,null,null),u=g.exports},91098:function(t,e,s){s.d(e,{A:function(){return c}});var o=function(){var t=this,e=t._self._c;return t.visible?e("div",{class:["ZoomDialogBackground",{ZoomDialogHidden:0==t.step},{ZoomDialogAnimation:t.step>=2}],on:{mousedown:t.close}},[e("div",{ref:"container",staticClass:"ZoomDialogContainer",on:{click:function(t){t.stopPropagation()},mousedown:function(t){t.stopPropagation()}}},[e("div",{ref:"wrapper",class:["ZoomDialogWrapper",{ZoomDialogWrapperOverflow:"visible"===t.overflow}]},[e("div",{ref:"content",staticClass:"ZoomDialogContent"},[t._t("default")],2)])])]):t._e()},a=[],i={name:"ZoomDialog",props:["overflow"],data:function(){return{visible:!1,step:0}},methods:{show(t){const e=this.position(t);this.visible=!0,this.step=0,setTimeout((()=>{this.animStep1(e)}),100)},animStep1(t){const e=this.$refs.container,s=this.$refs.content,o=this.position(s),a=t.w/o.w,i=t.h/o.h,r=Math.round(t.x-o.x),n=Math.round(t.y-o.y);e.style.transform=`translate(${r}px, ${n}px) scale(${a}, ${i})`,e.style.opacity=.3,this.step=1,setTimeout((()=>{this.animStep2()}),100)},animStep2(){this.step=2;const t=this.$refs.container;t.style.transform="scale(1,1)",t.style.opacity=1},close(){this.visible=!1,this.step=0},position(t,e=!1){if(t){t&&t.toLowerCase&&(t=document.getElementById(t));const s=t.getBoundingClientRect(),o={x:s.left,y:s.top,w:s.right-s.left,h:s.bottom-s.top};return e&&(o.x+=window.scrollX,o.y+=window.scrollY),o}return{x:0,y:0,w:100,h:100}},shake(){const t=this.$refs.wrapper;setTimeout((()=>{t.style.left="50px"}),1),setTimeout((()=>{t.style.left="-50px"}),51),setTimeout((()=>{t.style.left="50px"}),101),setTimeout((()=>{t.style.left="-50px"}),151),setTimeout((()=>{t.style.left="0px"}),201)}}},r=i,n=s(81656),l=(0,n.A)(r,o,a,!1,null,null,null),c=l.exports},75223:function(t,e,s){s.d(e,{A:function(){return m}});var o=function(){var t=this,e=t._self._c;return e("div",{staticClass:"MatcHeader",attrs:{id:""}},[e("div",{staticClass:"MatcHeaderLeft"},[e("a",{ref:"myPrototype",attrs:{href:"#/"}},[e("img",{ref:"logo",staticClass:"MatcHeaderLogo",attrs:{src:s(20195)}}),t._v(" Builder ")])]),t._m(0),e("div",{staticClass:"MatcHeaderRight"},[e("LanguagePicker",{on:{change:t.setLanguage}}),e("a",{attrs:{href:"#/logout.html"}},[e("QIcon",{attrs:{icon:"Logout"}})],1)],1)])},a=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"container MatcHeaderCenter"},[e("div",{staticClass:"MatcHeaderCenterLeft"}),e("div",{staticClass:"MatcHeaderCenterRight"})])}],i=s(28698),r=s(47681),n=s(56404),l=s(10950),c=s(15466),g=s(53721),u={name:"Header",mixins:[g.A],props:["user"],data:function(){return{}},watch:{user(t){this.logger.log(6,"watch","user >> "+t.email),this.user=t}},components:{LanguagePicker:l.A,QIcon:c.A},methods:{setLanguage(t){this.logger.log(-1,"setLanguage","entry",t),i.A.getUserService().setLanguage(t),this.$root.$i18n.locale=t,this.$root.$emit("Success",this.$i18n.t("common.language-changed"))},logout(){this.logger.log(2,"logout","entry"),i.A.getUserService().logout(),this.$emit("logout",i.A.getUserService().GUEST),(0,n.A)("/",!0)}},async mounted(){this.logger=new r.A("Header"),this.logger.log(7,"mounted","exit >> "+this.user.email),this.addTooltip(this.$refs.logo,this.$t("header.tooltip.my-prototypes")),this.addTooltip(this.$refs.myPrototype,this.$t("header.tooltip.my-prototypes"))}},h=u,d=s(81656),p=(0,d.A)(h,o,a,!1,null,null,null),m=p.exports},1977:function(t,e,s){s.r(e),s.d(e,{default:function(){return k}});var o=function(){var t=this,e=t._self._c;return e("div",{staticClass:"Matc"},[t.isGuest?e("LoginPage",{attrs:{user:t.user},on:{login:t.onLogin}}):e("div",{staticClass:"MatcContainer"},[t.hasHeader?e("QHeader",{attrs:{user:t.user},on:{login:t.onLogin,logout:t.onLogout}}):t._e(),e("router-view",{on:{logout:t.onLogout}})],1),e("ErrorDialog",{ref:"errorDialog"})],1)},a=[],i=function(){var t=this,e=t._self._c;return e("div",{class:"MatcLoginPage "+(t.resetToken?"MatcLoginPageReset":"MactMainGradient")},[t.isQuxAuth?e("div",{staticClass:"MatcLoginPageDialog"},[e("div",{staticClass:"MatcLoginPageContainer"},[t.resetToken?t._e():e("div",{staticClass:"MatcToolbarTabs MatcToolbarTabsBig"},[e("a",{class:{MatcToolbarTabActive:"login"===t.tab},on:{click:function(e){return t.setTab("login")}}},[t._v("Login")]),t.allowSignUp?e("a",{class:{MatcToolbarTabActive:"signup"===t.tab},on:{click:function(e){return t.setTab("signup")}}},[t._v("Sign Up")]):t._e()]),e("div",{class:" MatcLoginWrapper "+t.tab},[e("div",{staticClass:"MatcLoginContent"},[e("div",{staticClass:"MatcLoginPageSection"},[e("div",{staticClass:"MatcLoginPageForm"},[e("div",{staticClass:"form-group"},[e("label",{},[t._v("Email")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.email,expression:"email"}],staticClass:"form-control",attrs:{placeholder:"Your email",type:"text"},domProps:{value:t.email},on:{input:function(e){e.target.composing||(t.email=e.target.value)}}})]),e("div",{staticClass:"form-group has-feedback"},[e("label",{},[t._v("Password")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],staticClass:"form-control",attrs:{placeholder:"Your password",type:"password"},domProps:{value:t.password},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.login.apply(null,arguments)},input:function(e){e.target.composing||(t.password=e.target.value)}}})]),e("span",{directives:[{name:"show",rawName:"v-show",value:t.errorMessage,expression:"errorMessage"}],staticClass:"MatcErrorLabel"},[t._v(t._s(t.errorMessage))])]),e("div",{staticClass:"MatcButtonBar"},[e("a",{staticClass:"MatcButton MatcButtonPrimary",on:{click:t.login}},[t._v("Login")]),t.hasLoginError?e("a",{staticClass:"MatcLinkButton",on:{click:t.requestPasswordReset}},[t._v("Reset Password")]):t._e()])])]),t._v(" "),e("div",{staticClass:"MatcLoginContent"},[e("div",{staticClass:"MatcLoginPageSection"},[e("div",{staticClass:"MatcLoginPageForm"},[e("div",{staticClass:"form-group"},[e("label",{},[t._v("Email")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.email,expression:"email"}],staticClass:"form-control",attrs:{placeholder:"Your email",type:"text"},domProps:{value:t.email},on:{input:function(e){e.target.composing||(t.email=e.target.value)}}})]),e("div",{staticClass:"form-group has-feedback"},[e("label",{},[t._v("Password")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],staticClass:"form-control",attrs:{placeholder:"Your password",type:"password"},domProps:{value:t.password},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.signup.apply(null,arguments)},input:function(e){e.target.composing||(t.password=e.target.value)}}})]),e("div",{staticClass:"form-group has-feedback"},[e("div",{staticClass:"MatcCheckboxRow"},[e("CheckBox",{attrs:{label:""},model:{value:t.tos,callback:function(e){t.tos=e},expression:"tos"}}),e("span",{on:{click:function(e){t.tos=!0}}},[t._v("I accept the "),e("a",{attrs:{href:"#/tos.html",target:"_blank"}},[t._v("terms of service")])])],1)]),e("span",{staticClass:"MatcErrorLabel"},[t._v(t._s(t.errorMessage))])]),e("div",{staticClass:"MatcButtonBar"},[e("a",{staticClass:"MatcButton MatcButtonPrimary",on:{click:t.signup}},[t._v("SignUp")])])])]),t._v(" "),e("div",{staticClass:"MatcLoginContent"},[t.resetToken?e("div",{staticClass:"MatcLoginPageSection"},[e("div",{staticClass:"MatcLoginPageForm"},[e("div",{staticClass:"form-group"},[e("label",{},[t._v("Email")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.email,expression:"email"}],staticClass:"form-control",attrs:{placeholder:"Your email",type:"text"},domProps:{value:t.email},on:{input:function(e){e.target.composing||(t.email=e.target.value)}}})]),e("div",{staticClass:"form-group has-feedback"},[e("label",{},[t._v("New Password")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],staticClass:"form-control",attrs:{placeholder:"The new password",type:"password"},domProps:{value:t.password},on:{input:function(e){e.target.composing||(t.password=e.target.value)}}})])]),e("span",{staticClass:"MatcErrorLabel"},[t._v(t._s(t.errorMessage))]),e("div",{staticClass:"MatcButtonBar"},[e("a",{staticClass:"MatcButton MatcButtonDanger",on:{click:t.resetPassword}},[t._v("Set new password")])])]):t._e()])])])]):t._e()])},r=[],n=(s(44114),s(28698)),l=s(47681),c=s(60993),g={name:"Header",mixins:[],props:["user"],data:function(){return{hasLoginError:!1,resetToken:!1,email:"",password:"",tos:!1,errorMessage:" ",tab:"signup",config:{}}},computed:{isQuxAuth(){return"keycloak"!==n.A.getConfig().auth},allowSignUp(){return this.config&&this.config.user&&!0===this.config.user.allowSignUp}},watch:{user(t){this.logger.log(6,"watch","user >> "+t.email),this.user=t}},components:{CheckBox:c.A},methods:{setTab(t){this.tab=t,this.errorMessage=" "},async resetPassword(){if(this.logger.info("resetPassword","enter ",this.email),this.email.length<2)return void(this.errorMessage="Please enter your email");if(this.password.length<6)return void(this.errorMessage="Password too short");if(this.resetToken.length<6)return void(this.errorMessage="Token is wrong");let t=await n.A.getUserService().reset2(this.email,this.password,this.resetToken);"error"===t.type?this.errorMessage="Someything is wrong":(this.errorMessage="",this.resetToken="",this.tab="login",this.$router.push("/"))},async requestPasswordReset(){this.logger.info("requestPasswordReset","enter ",this.email),await n.A.getUserService().reset(this.email),this.errorMessage="Check you mail."},async login(){this.logger.info("login","enter ",this.email);var t=await n.A.getUserService().login({email:this.email,password:this.password});"error"==t.type?(this.$root.$emit("Error","Wrong login credentials"),this.errorMessage="Login is wrong",this.hasLoginError=!0):(this.$emit("login",t),this.$root.$emit("UserLogin",t),this.hasLoginError=!1)},async signup(){if(this.logger.info("signup","enter ",this.email),this.password.length<6)this.errorMessage="Password too short";else if(!0===this.tos){var t=await n.A.getUserService().signup({email:this.email,password:this.password,tos:this.tos});if("error"==t.type)t.errors.indexOf("user.create.domain")>=0?this.errorMessage="Not the correct domain":t.errors.indexOf("user.create.nosignup")>=0?this.errorMessage="No sign-ups allowed.":t.errors.indexOf("user.email.not.unique")>=0?this.errorMessage="Email is taken":this.errorMessage="Password too short";else{let t=await n.A.getUserService().login({email:this.email,password:this.password});this.$emit("login",t),this.$root.$emit("UserLogin",t),this.logger.log(-1,"signup","exit with login",this.email)}}else this.errorMessage="Please accept terms of service"},initKeyCloak(t){const e=n.A.getUserService();e.init(t)}},async mounted(){this.logger=new l.A("LoginPage"),this.resetToken=this.$route.query.id,this.resetToken&&this.resetToken.length>2&&(this.logger.log(-1,"mounted","reset "),this.tab="reset"),this.config=n.A.getConfig(),this.logger.log(1,"mounted","exit > ")}},u=g,h=s(81656),d=(0,h.A)(u,i,r,!1,null,null,null),p=d.exports,m=s(75223),v=s(59740),f=s(71364),w=s(97941),C={name:"home",mixins:[],data:function(){return{hasHeader:!1,isDebug:!1,user:{id:-1,name:"Guest",email:"guest@quant-ux.com",role:"guest",lastlogin:0,lastNotification:0,tos:!1,paidUntil:0,plan:"Free"}}},components:{QHeader:m.A,ErrorDialog:v.A,LoginPage:p},computed:{isGuest(){return"guest"===this.user.role}},methods:{onLogin(t){this.user=t,this.logger.info("onLogin","exit >> "+this.user.email)},onLogout(t){console.debug("onLogout","enter"),this.user=t,this.logger.info("onLogout","exit >> "+this.user.email)},scrollTop(){window.scrollTo(0,0)},initRoute(){w.A.remove(f.A.body(),"MatcPublic"),w.A.remove(f.A.body(),"MatcVisualEditor"),w.A.remove(f.A.body(),"MatcLight"),this.scrollTop(),!0===this.$route.meta.hasHeader?this.hasHeader=!0:this.hasHeader=!1},showErrorDetails(t,e){this.isDebug&&this.$refs.errorDialog.show(t,e)}},watch:{$route(){this.initRoute()}},async mounted(){this.logger=new l.A("QUX"),l.A.setErrorCallback(((t,e)=>this.showErrorDetails(t,e))),this.initRoute(),this.user=await n.A.getUserService().load(),this.logger.log(-1,"mounted","locale: "+navigator.language),window.onerror=(t,e,s,o,a)=>(this.showErrorDetails(a,e),!0),this.$root.$on("MatcLogout",(t=>{this.onLogout(t)}))}},M=C,y=(0,h.A)(M,o,a,!1,null,null,null),k=y.exports}}]);
//# sourceMappingURL=977.a41f0f69.js.map